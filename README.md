# Система управления мероприятиями

Мобильное приложение для управления календарем мероприятий с системой ролей пользователей, построенное на Flutter и Firebase.

## 📋 Описание проекта

Приложение предназначено для организации и планирования мероприятий в организациях с иерархической структурой управления. Система поддерживает три типа пользователей: администраторы, депутаты и сотрудники, каждый из которых имеет свои права доступа.

### Основные возможности

- 📅 **Календарь мероприятий** с различными типами событий
- 👥 **Система ролей** (администратор, депутат, сотрудник)
- 🔐 **Безопасная аутентификация** через Firebase Auth
- 📱 **Кроссплатформенность** (iOS, Android, Web, Desktop)
- 🔄 **Реальное время** синхронизация данных
- 📝 **Управление профилем** пользователя

## 🛠 Стек технологий

- **Frontend:** Flutter 3.x
- **Backend:** Firebase (Auth, Firestore)
- **Архитектура:** Provider pattern
- **Платформы:** iOS, Android, Web, Windows

### Основные зависимости

```yaml
dependencies:
  flutter: sdk
  firebase_auth: ^4.x.x
  cloud_firestore: ^4.x.x
  provider: ^6.x.x
  table_calendar: ^3.x.x
  intl: ^0.x.x
```

## ⚙️ Требования к системе

### Для разработки:
- Flutter SDK ≥ 3.0.0
- Dart SDK ≥ 3.0.0
- Android Studio / VS Code
- Git

### Для пользователей:
- **Android:** API level 21+ (Android 5.0+)
- **iOS:** iOS 11.0+
- **Web:** Современные браузеры
- **Windows:** Windows 10+

## 🚀 Установка и настройка

### 1. Клонирование репозитория
```bash
git clone https://github.com/housesaroma/flutter_hackathon
cd personal account for the deputy
```

### 2. Установка зависимостей
```bash
flutter pub get
```

### 3. Настройка Firebase

1. Создайте проект в Firebase Console
2. Активируйте Authentication и Firestore Database
3. Добавьте конфигурационные файлы:
   - `android/app/google-services.json`
   - `ios/Runner/GoogleService-Info.plist`
   - `web/firebase-config.js`

### 4. Структура базы данных Firestore

```
users/
  {uid}/
    name: string
    email: string
    isDeputy: boolean
    isAdmin: boolean
    deputyId: string (optional)
    phone: string (optional)
    department: string (optional)
    createdAt: timestamp

events/
  {eventId}/
    title: string
    description: string
    startTime: timestamp
    endTime: timestamp
    location: string
    type: string (meeting|session|reception|other)
    deputyId: string
    createdBy: string
    notes: string (optional)
```

### 5. Сборка и запуск

```bash
# Разработка
flutter run

# Сборка для продакшена
flutter build apk --release        # Android
flutter build ios --release        # iOS
flutter build web --release        # Web
flutter build windows --release    # Windows
```

## 📱 Функциональность приложения

### Система ролей

#### 🔵 Администратор
- Просмотр всех мероприятий
- Создание/редактирование/удаление мероприятий для любого депутата
- Полный доступ к системе

#### 🟢 Депутат
- Просмотр своих мероприятий
- Создание/редактирование своих мероприятий

#### 🟡 Помощник депутата
- Просмотр мероприятий назначенного депутата
- Только чтение

### Экраны приложения

#### 🔐 Аутентификация
- Вход: Email/пароль с валидацией
- Регистрация: с выбором роли и привязкой к депутату
- Восстановление пароля (запрос у администратора на смену пароля)

#### 📅 Календарь
- Месячный вид, выбор даты
- Цветовая индикация типов
- Детали события

#### ➕ Создание мероприятий
- Форма с валидацией
- Выбор даты/времени, типа, места
- Привязка к депутату

#### 📋 Список мероприятий
- Хронологический список
- Фильтрация по ролям

#### 👤 Профиль
- Редактирование имени, телефона, отдела
- Привязка к депутату (для сотрудников)

### Типы мероприятий

| Тип | Описание | Цвет |
|-----|----------|------|
| 🔵 Совещание | Рабочие встречи | Синий |
| 🟢 Заседание | Официальные заседания | Зеленый |
| 🟠 Прием | Прием граждан | Оранжевый |
| ⚫ Другое | Прочие мероприятия | Серый |

## 📁 Структура проекта

```
lib/
├── models/
│   ├── user_model.dart
│   └── event_model.dart
├── services/
│   ├── auth_service.dart
│   └── event_service.dart
├── screens/
│   ├── auth/
│   │   ├── login_screen.dart
│   │   └── register_screen.dart
│   ├── calendar_screen.dart
│   ├── create_event_screen.dart
│   ├── events_screen.dart
│   ├── profile_screen.dart
│   ├── main_screen.dart
│   └── splash_screen.dart
└── main.dart

windows/
└── runner/ ...

test/
└── widget_test.dart
```

## 🔧 Архитектура

Приложение использует **Provider pattern** для управления состоянием и разделения ответственности:
- **AuthService** — аутентификация и профиль пользователя
- **EventService** — CRUD по мероприятиям с проверкой прав
- **Models** — типизированные сущности
- **Screens** — UI слой

Диаграмма:
```
┌─────────────┐    ┌──────────────┐    ┌─────────────┐
│   Screens   │────│   Services   │────│  Firebase   │
│     (UI)    │    │ (Business)   │    │ (Backend)   │
└─────────────┘    └──────────────┘    └─────────────┘
       │                   │                   │
       │            ┌─────────────┐            │
       └────────────│   Models    │────────────┘
                    │   (Data)    │
                    └─────────────┘
```

## ⚡ Эффективность

Применены подходы для снижения задержек и экономии ресурсов:
- **Потоковые обновления** через `authStateChanges()` и `snapshots()` для реактивной подгрузки без опроса БД (минимум сетевых вызовов)
- **Серверная фильтрация и сортировка** (`where`, `orderBy`) — выборка только релевантных событий по ролям и дате
- **Узкие запросы по дате** (границы дня и индексация `startTime`) для уменьшения объема данных
- **Минимизация пересылки** — использование `millisecondsSinceEpoch` и компактных моделей
- **Локальная валидация форм** и ранние возвраты для предотвращения лишних запросов



## 🔒 Безопасность

В приложении реализованы четкие ограничения на уровне бизнес-логики и предполагаемых правил Firestore:
- **Администратор:** полный доступ
- **Депутат:** доступ только к событиям
- **Сотрудник:** доступ только к событиям депутата, к которому привязан сотрудник
- **Создание/редактирование:** запреты на изменение после создания, удаление только автором события (если не администратор)



## 🛡 Практики безопасности клиента
- Валидация всех форм и ограничение ролей в UI
- Скрытие административных функций для не-админов
- Обработка ошибок FirebaseAuthException с безопасными сообщениями
- Использование HTTPS, запрет хранения секретов в клиенте

## 🧪 Тестирование



## 🧭 Админка (Firebase Console)

- **Authentication:** управление пользователями, сброс паролей, проверка статусов
- **Firestore:** просмотр/редактирование коллекций `users` и `events`, настройка индексов и правил
- **Storage/Hosting (опционально):** хранение медиа и деплой web-версии
- Рекомендуется ограничить доступ к консоли через IAM и создавать отдельные роли для оператора контента

## 📈 Производительность
- Реактивные стримы вместо ручного опроса
- Серверные фильтры и сортировки
- Индексы Firestore по `startTime` и `deputyId`

## 🎨 UI/UX
- Material Design 3, адаптивная верстка, доступность

## 📝 Демо-данные
Депутат:
- Email: 
- Пароль: 

Сотрудник:
- Email: 
- Пароль: 

## 🤝 Contributing
- Fork → Branch → Commit → PR

## 📄 Лицензия
MIT

## 👨‍💻 Авторы
- Главный разработчик — @housesaroma

**Версия:** 1.0.0  
**Последнее обновление:** Октябрь 2025